# Maintainer: Anthony Davies <anthony.t.davies@gmail.com>
pkgname=jemalloc
pkgver=5.2.1
pkgrel=0
pkgdesc="NFS-Ganesha is an NFSv3,v4,v4.1 fileserver that runs in user mode"
url="https://github.com/jemalloc/jemalloc"
arch="x86_64 aarch64 armv7"
license="Redistribution"
options="!check"
makedepends="bash coreutils findutils go linux-headers rsync grep musl-dev autoconf" 
source="$pkgname-$pkgver.tar.gz::https://github.com/jemalloc/jemalloc/archive/$pkgver.tar.gz"
subpackages="$pkgname-doc $pkgname-dev"

build() {
        cd "$builddir"
	./autogen.sh
	make distclean
	./configure --prefix=/usr --enable-shared --disable-static
	sed -i -e "s/Version: 0.0.0_0/Version: $pkgver/" jemalloc.pc
	make
}

package() {
        cd "$builddir"
	make DESTDIR="$pkgdir" install
}
sha512sums="a645cb01e9ec9947d12fad1d5584adf3996d8ae996081a089f8a0372ca05397487c60ead1c7610deac8bafd6efcdbd13119eb700371e0ca42dd356cbd4a5c81a  jemalloc-5.2.1.tar.gz"
