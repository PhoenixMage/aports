# Maintainer: Anthony Davies <anthony.t.davies@gmail.com>
pkgname=kaniko
pkgver=0.16.0
pkgrel=3
pkgdesc="Build Container Images In Kubernetes"
url="https://github.com/GoogleContainerTools/kaniko"
arch="x86_64 aarch64 armv7"
license="Apache-2.0"
options="!check"
makedepends="go bash" 
source="$pkgname-$pkgver.tar.gz::https://github.com/GoogleContainerTools/$pkgname/archive/v$pkgver.tar.gz
	646_rebase_with_goarm.patch"
builddir="$srcdir/src/github.com/GoogleContainerTools/$pkgname"
export GOPATH="$srcdir"


prepare() {
	mkdir -p ${builddir%/*}
	mv "$srcdir"/$pkgname-$pkgver "$builddir"/ || return 0
	cd "$builddir"
	default_prepare
}


build() {
	make
}

package() {
	cd $builddir
	mkdir -p $pkgdir/usr/bin
	cp $builddir/out/executor $pkgdir/usr/bin
}

clean() {
	rm -rf $srcdir $startdir/pkg
}

sha512sums="13391b226a4c6827ec37dfcd3a94d3ada9d93b4f024a0afddd44ea01667b3c5fb7a011e7793b72cb83646891d536224470f540c22ae7f7c88e60486686a21db2  kaniko-0.16.0.tar.gz
afc8de76bc4db30fef7c6adf121d7ebc77633bf8e992415afc9bee9debbdf82fc0e42d786104931b347e263024d58d6c272acd5c0ba3c35c6719ea4b1c36ab19  646_rebase_with_goarm.patch"
