# Maintainer: Anthony Davies <anthony.t.davies@gmail.com>
pkgname=kaniko
pkgver=0.16.0
pkgrel=3
pkgdesc="Build Container Images In Kubernetes"
url="https://github.com/GoogleContainerTools/kaniko"
arch="x86_64 aarch64 armv7"
license="Apache-2.0"
options="!check"
makedepends="go bash" 
source="$pkgname-$pkgver.tar.gz::https://github.com/GoogleContainerTools/$pkgname/archive/v$pkgver.tar.gz
	646_rebase_with_goarm.patch"
builddir="$srcdir/src/github.com/GoogleContainerTools/$pkgname"
export GOPATH="$srcdir"


prepare() {
	mkdir -p ${builddir%/*}
	mv "$srcdir"/$pkgname-$pkgver "$builddir"/ || return 0
	cd "$builddir"
	default_prepare
}


build() {
	make
}

package() {
	cd $builddir
	mkdir -p $pkgdir/usr/bin
	cp $builddir/out/executor $pkgdir/usr/bin
}

clean() {
	rm -rf $srcdir $startdir/pkg
}

sha512sums="13391b226a4c6827ec37dfcd3a94d3ada9d93b4f024a0afddd44ea01667b3c5fb7a011e7793b72cb83646891d536224470f540c22ae7f7c88e60486686a21db2  kaniko-0.16.0.tar.gz
a6cf37773fc077c818adb99d15e54dc57b814941bdcec37ef3f08ce83daad0250174c6fe2fb38f0b0a4203ae89cf77e713e27c476b02bac2ab2426d25ef635c6  646_rebase_with_goarm.patch"
