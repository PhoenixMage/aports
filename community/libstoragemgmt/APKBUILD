# Contributor: Anthony Davies <anthony.t.davies@gmail.com>
# Maintainer:
pkgname="libstoragemgmt"
pkgver="1.8.2"
pkgrel=2
pkgdesc="Storage array management library"
url="https://github.com/libstorage/libstoragemgmt"
arch="x86_64 aarch64 armv7"
license="LGPL"
options="!check"
subpackages="$pkgname-doc $pkgname-dev"
depends="py3-six"
makedepends_host="
        sqlite-dev
        libxml2-dev
        glib-dev
        check-dev
        libconfig-dev
        bsd-compat-headers
        eudev-dev
        python3-dev
        perl
        openssl-dev
"
checkdepends="
        check
        chrpath
        valgrind
        libtool
"
install=""
source="https://github.com/libstorage/$pkgname/releases/download/$pkgver/$pkgname-$pkgver.tar.gz"

build() {
        pip3 install --user pywbem
        cd "$builddir"
        ./configure \
                --host=$CHOST \
                --build=$CBUILD \
                --prefix=/usr \
                --with-python3 \
                --without-test \
                --disable-static 
        make
#	pip3 uninstall -y pywbem
}

check() {
        make check
}


package() {
        cd "$builddir"
        make DESTDIR="$pkgdir" install
}

sha512sums="d6b8d0103f89783ad8cc7f78b642669cb896abe95cff27e8ae5b91872d5edb81a2e8886412ad32f0b716d17f50c8c1d286786949d5b136d71f320ad66cb0e6af  libstoragemgmt-1.8.2.tar.gz"
